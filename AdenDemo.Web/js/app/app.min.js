(function(){function i(i,r){var u="/api/workitem/complete/"+r.id;$.ajax({url:u,type:"POST",success:function(){n.refresh();t.refresh()},error:function(){}}).always(function(){})}function r(i,r){var u="/api/workitem/reject/"+r.id;$.ajax({url:u,type:"POST",success:function(){n.refresh();t.refresh()},error:function(){}}).always(function(){})}function u(i,r){var u="/api/workitem/cancel/"+r.id;$.ajax({url:u,type:"POST",success:function(){n.refresh();t.refresh()},error:function(){}}).always(function(){})}function f(i,r){console.log("show report errors");var u="/home/errorreport/"+r.id,f="/home/reporterror";BootstrapDialog.show({size:window.BootstrapDialog.SIZE_WIDE,draggable:!0,title:"Submission Errors",message:$("<div><\/div>").load(u,function(n,t){t==="error"}),buttons:[{label:"Close",action:function(n){n.close()}},{label:"Save",cssClass:"btn-primary",action:function(i){var u,r;if($("#errorMessage").text(""),u=new FormData($("form")[0]),files.length>0)for(r=0;r<files.length;r++)u.append("file",files[r]);$.ajax({type:"POST",url:f,data:u,contentType:!1,processData:!1,success:function(){n.refresh();t.refresh();i.close()},error:function(){},complete:function(){}})}}]})}function e(n,t){var i="/home/workitemimages/"+t.id;BootstrapDialog.show({size:window.BootstrapDialog.SIZE_WIDE,draggable:!0,title:"Error Details",message:$("<div><\/div>").load(i,function(n,t){t==="error"}),buttons:[{label:"Close",action:function(n){n.close()}}]})}var n=$("#gridCurrent").dxDataGrid({dataSource:DevExpress.data.AspNet.createStore({key:"id",loadUrl:"/api/workitem/mark@mail.com/"}),remoteOperations:!0,allowColumnResizing:!0,showBorders:!0,columnResizingMode:"nextColumn",columnMinWidth:50,columnAutoWidth:!0,wordWrapEnabled:!0,height:300,filterRow:{visible:!1},headerFilter:{visible:!1},groupPanel:{visible:!1},scrolling:{mode:"virtual",rowRenderingMode:"virtual"},paging:{pageSize:20},columns:[{dataField:"displayFileName",caption:"File Name"},{dataField:"dataYear",caption:"Data Year",width:75},{dataField:"assignedDate",caption:"Assigned",dataType:"datetime",width:150},{dataField:"dueDate",caption:"Due",dataType:"datetime",width:150},{alignment:"center",cellTemplate:function(n,t){t.data.canGenerate||$("<a/>").addClass("btn btn-default  btn-sm btn-grid").text("Review File").attr("href","/review/"+t.data.dataYear+"/"+t.data.fileNumber).attr("target","_blank").appendTo(n);$("<a/>").addClass("btn btn-success btn-sm btn-grid").text(t.data.actionName).on("dxclick",function(){i($(this),t.data)}).appendTo(n);t.data.canReject&&$("<a/>").addClass("btn btn-danger btn-sm btn-grid").text("Reject File").on("dxclick",function(){r($(this),t.data)}).appendTo(n);t.data.canSubmit&&$("<a/>").addClass("btn btn-danger btn-sm btn-grid").text("Report Errors").on("dxclick",function(){f($(this),t.data)}).appendTo(n);t.data.canReviewError&&$("<a/>").addClass("btn btn-danger btn-sm btn-grid").text("View Errors").on("dxclick",function(){e($(this),t.data)}).appendTo(n)}},],onToolbarPreparing:function(n){var t=n.component;n.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{icon:"refresh",onClick:function(){t.refresh()}}})}}).dxDataGrid("instance"),t=$("#gridComplete").dxDataGrid({dataSource:DevExpress.data.AspNet.createStore({key:"id",loadUrl:"/api/workitem/finished/mark@mail.com/"}),remoteOperations:!0,allowColumnResizing:!0,showBorders:!0,columnResizingMode:"nextColumn",columnMinWidth:50,columnAutoWidth:!0,wordWrapEnabled:!0,height:300,columns:[{dataField:"displayFileName",caption:"File Name"},{dataField:"dataYear",caption:"Data Year"},{dataField:"assignedDate",caption:"Assigned",dataType:"datetime"},{dataField:"completedDate",caption:"Completed",dataType:"datetime"},{dataField:"actionName",caption:"Action"},{width:150,alignment:"center",cellTemplate:function(n,t){t.data.canCancel&&$("<a/>").addClass("btn btn-default btn-sm btn-grid").text("Cancel").on("dxclick",function(){u($(this),t.data)}).appendTo(n)}},],filterRow:{visible:!1},headerFilter:{visible:!1},groupPanel:{visible:!1},scrolling:{mode:"virtual",rowRenderingMode:"virtual"},paging:{pageSize:20},onToolbarPreparing:function(n){var t=n.component;n.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{icon:"refresh",onClick:function(){t.refresh()}}})}}).dxDataGrid("instance")})(),function(){function i(t,i){var r=i.id;$.ajax({url:"/api/filespecification/activate/"+r,type:"POST",success:function(){n.refresh()},error:function(n){console.log("err",n)}}).always(function(){})}function r(t,i){var r=i.id;$.ajax({url:"/api/filespecification/retire/"+r,type:"POST",success:function(){n.refresh()},error:function(n){console.log("err",n)}}).always(function(){})}function u(t,i){var r="/home/editfileSpecification/"+i.id,u="/api/filespecification/"+i.id;BootstrapDialog.show({type:BootstrapDialog.TYPE_WARNING,size:window.BootstrapDialog.SIZE_WIDE,draggable:!0,title:"Edit File Specification",message:$("<div><\/div>").load(r,function(n,t){t==="error"&&window.$log.error("Error showing history")}),buttons:[{label:"Close",action:function(n){n.close()}},{label:"Save",cssClass:"btn-primary",action:function(t){var i=$("form").serializeJSON();$.ajax({contentType:"application/json; charset=utf-8",type:"PUT",url:u,data:JSON.stringify(i),dataType:"json",success:function(){t.close();n.refresh()},error:function(n){console.log("error",n)},complete:function(n){console.log("complete",n)}})}}]})}var t="/api/filespecification",n=$("#grid").dxDataGrid({dataSource:DevExpress.data.AspNet.createStore({key:"id",loadUrl:t,updateUrl:t}),remoteOperations:!0,allowColumnResizing:!0,showBorders:!0,columnResizingMode:"nextColumn",columnMinWidth:50,columnAutoWidth:!0,columns:[{dataField:"fileNumber",caption:"File Number"},{dataField:"fileName",caption:"File Name"},{dataField:"isRetired",caption:"Retired",dataType:"boolean",visible:!0,showEditorAlways:!1,trueText:"Yes",falseText:"No",customizeText:function(n){return n.value?"Yes":"No"}},{dataField:"section",caption:"Section"},{dataField:"supportGroup",caption:"Support Group"},{dataField:"application",caption:"Application"},{dataField:"collection",caption:"Collection"},{dataField:"generationUserGroup",caption:"Generation Group"},{dataField:"approvalUserGroup",caption:"Approval Group"},{dataField:"submissionUserGroup",caption:"Submission Group"},{width:120,alignment:"center",cellTemplate:function(n,t){$("<a/>").addClass("btn btn-default btn-sm btn-grid").text("Edit").on("dxclick",function(){u($(this),t.data)}).appendTo(n);t.data.canRetire&&$("<a/>").addClass("btn btn-default btn-sm btn-grid").text("Retire").on("dxclick",function(){r($(this),t.data)}).appendTo(n);t.data.canActivate&&$("<a/>").addClass("btn btn-default btn-sm btn-grid").text("Activate").on("dxclick",function(){i($(this),t.data)}).appendTo(n)}},],wordWrapEnabled:!0,columnChooser:{enabled:!0},stateStoring:{enabled:!0,type:"localStorage",storageKey:"gridFileSpecificationFilterStorage"},filterRow:{visible:!0},headerFilter:{visible:!0},groupPanel:{visible:!0},scrolling:{mode:"virtual",rowRenderingMode:"virtual"},paging:{pageSize:20},height:400,sortByGroupSummaryInfo:[{summaryItem:"count"}],summary:{totalItems:[{column:"id",displayFormat:"{0} Total File Specifications",summaryType:"count",showInGroupFooter:!0,showInColumn:"FileNumber"},],groupItems:[{summaryType:"count",displayFormat:"{0} File Specifications"},]},onToolbarPreparing:function(n){var t=n.component;n.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{text:"Collapse All",width:136,onClick:function(n){var i=n.component.option("text")==="Expand All";t.option("grouping.autoExpandAll",i);n.component.option("text",i?"Collapse All":"Expand All")}}},{location:"after",widget:"dxButton",options:{icon:"refresh",onClick:function(){t.refresh()}}},{location:"after",widget:"dxButton",options:{icon:"fa fa-undo",onClick:function(){t.state({})}}})}}).dxDataGrid("instance")}(),function(){console.log("review ready");$(document).on("click","a[data-doc-id]",function(){var t=$(this).data("doc-id"),n=$(this),i=n.data("title"),r=n.data("url");BootstrapDialog.show({size:BootstrapDialog.SIZE_WIDE,draggable:!0,title:i,message:$("<div><\/div>").load(r,function(n,t){t==="error"&&window.$log.error("Error showing history")}),buttons:[{label:"Close",action:function(n){n.close()}},{label:"Download",cssClass:"btn-primary",action:function(n){var i="/download/"+t;window.downloadFile(i);window.$log.info("Your file is being downloaded");n.close()}}]})})}();$(function(){function i(n){var t="/history/"+n.row.data.id;console.log(n.row.data);BootstrapDialog.show({size:window.BootstrapDialog.SIZE_WIDE,draggable:!0,title:"History",message:$("<div><\/div>").load(t,function(n,t){t==="error"}),buttons:[{label:"Close",action:function(n){n.close()}}]})}function r(t,i){var r=i.id;$.ajax({url:"/api/submission/start/"+r,type:"POST",success:function(t){console.log("success",t);n.refresh()},error:function(n){console.log("error",n)},complete:function(n){console.log("complete",n)}})}function u(t,i){var r=i.id;$.ajax({url:"/api/submission/cancel/"+r,type:"POST",success:function(t){console.log("success",t);n.refresh()},error:function(n){console.log("error",n)},complete:function(n){console.log("complete",n)}})}function f(t,i){var r="/home/reopen/"+i.id,u="/api/submission/reopen/"+i.id;BootstrapDialog.show({size:window.BootstrapDialog.SIZE_WIDE,draggable:!0,title:"Reopen Reason",message:$("<div><\/div>").load(r,function(n,t){t==="error"&&window.$log.error("Error showing history")}),buttons:[{label:"Close",action:function(n){n.close()}},{label:"Save",cssClass:"btn-primary",action:function(t){var i=$("form").serializeJSON();$.ajax({contentType:"application/json;",type:"POST",url:u,data:JSON.stringify(i),dataType:"json",success:function(i){console.log("success",i);t.close();n.refresh()},error:function(n){console.log("error",n)},complete:function(n){console.log("complete",n)}})}}]})}function e(t,i){var r="/home/waiver/"+i.id,u="/api/submission/waive/"+i.id;BootstrapDialog.show({size:window.BootstrapDialog.SIZE_WIDE,draggable:!0,title:"Waiver Reason",message:$("<div><\/div>").load(r,function(n,t){t==="error"&&window.$log.error("Error showing history")}),buttons:[{label:"Close",action:function(n){n.close()}},{label:"Save",cssClass:"btn-primary",action:function(t){var i=$("form").serializeJSON();$.ajax({contentType:"application/json; charset=utf-8",type:"POST",url:u,data:JSON.stringify(i),success:function(){t.close();n.refresh()},error:function(n){console.log("error",n)},complete:function(n){console.log("complete",n)}})}}]})}console.log("submission view ready");var t="/api/submission",n=$("#grid").dxDataGrid({dataSource:DevExpress.data.AspNet.createStore({key:"id",loadUrl:t,updateUrl:t}),remoteOperations:!0,allowColumnResizing:!0,showBorders:!0,columnResizingMode:"nextColumn",columnMinWidth:50,columnAutoWidth:!0,columns:[{width:50,type:"buttons",buttons:["edit","delete",{text:"History",icon:"fa fa-history",hint:"History",onClick:function(n){i(n)}}]},{dataField:"fileNumber",caption:"File Number"},{dataField:"fileName",caption:"File Name"},{dataField:"submissionStateDisplay",caption:"Status"},{dataField:"currentAssignee",caption:"Assigned"},{dataField:"lastUpdatedFriendly",caption:"Last Update"},{dataField:"deadlineDate",caption:"Submission Deadline",dataType:"date"},{dataField:"submissionDate",caption:"Date Submitted",dataType:"date"},{dataField:"displayDataYear",caption:"Data Year"},{dataField:"section",caption:"Section"},{dataField:"isSEA",caption:"SEA",dataType:"boolean",visible:!0,showEditorAlways:!1,trueText:"Yes",falseText:"No",customizeText:function(n){return n.value?"Yes":"No"}},{dataField:"isLEA",caption:"LEA",dataType:"boolean",visible:!0,showEditorAlways:!1,trueText:"Yes",falseText:"No",customizeText:function(n){return n.value?"Yes":"No"}},{dataField:"isSCH",caption:"SCH",dataType:"boolean",visible:!0,showEditorAlways:!1,trueText:"Yes",falseText:"No",customizeText:function(n){return n.value?"Yes":"No"}},{width:200,alignment:"center",cellTemplate:function(n,t){t.data.canStart&&$("<a/>").addClass("btn btn-default btn-sm btn-grid").text("Start").on("dxclick",function(){r($(this),t.data)}).appendTo(n);t.data.canCancel&&$("<a/>").addClass("btn btn-default btn-sm btn-grid").text("Cancel").on("dxclick",function(){u($(this),t.data)}).appendTo(n);t.data.canReview&&$("<a/>").addClass("btn btn-default btn-sm btn-grid").text("Review File").attr("href","/review/"+t.data.dataYear+"/"+t.data.fileNumber).attr("target","_blank").appendTo(n);t.data.canReopen&&$("<a/>").addClass("btn btn-default btn-sm btn-grid").text("Reopen").on("dxclick",function(){f($(this),t.data)}).appendTo(n);t.data.canWaiver&&$("<a/>").addClass("btn btn-default btn-sm btn-grid").text("Waiver").on("dxclick",function(){e($(this),t.data)}).appendTo(n)}},],wordWrapEnabled:!0,columnChooser:{enabled:!0},"export":{enabled:!0,fileName:"Submissions",allowExportSelectedData:!1,icon:"fa fa-trash"},stateStoring:{enabled:!0,type:"localStorage",storageKey:"gridSubmissionFilterStorage"},filterRow:{visible:!0},headerFilter:{visible:!0},groupPanel:{visible:!0},scrolling:{mode:"virtual",rowRenderingMode:"virtual"},paging:{pageSize:20},height:650,sortByGroupSummaryInfo:[{summaryItem:"count"}],summary:{totalItems:[{column:"id",displayFormat:"{0} Total Submissions",summaryType:"count",showInGroupFooter:!0,showInColumn:"FileNumber"},],groupItems:[{summaryType:"count",displayFormat:"{0} Submissions"},]},onToolbarPreparing:function(n){var t=n.component;n.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{text:"Collapse All",width:136,onClick:function(n){var i=n.component.option("text")==="Expand All";t.option("grouping.autoExpandAll",i);n.component.option("text",i?"Collapse All":"Expand All")}}},{location:"after",widget:"dxButton",options:{icon:"refresh",hint:"Refresh Data",onClick:function(){t.refresh()}}},{location:"after",widget:"dxButton",options:{icon:"fa fa-undo",hint:"Reset Grid",onClick:function(){t.state({})}}})}}).dxDataGrid("instance")});