$(function(){function r(n){var i=n.component.getDataSource(),t=n.field,u,r;t&&(t.groupName&&t.groupIndex!==0||n.items.push({text:"Hide field",onItemClick:function(){var n;n=t.groupName?i.getAreaFields(t.area,!0)[t.areaIndex].index:t.index;i.field(n,{area:null});i.load()}}),t.dataType==="number"&&(u=function(n){i.field(t.index,{summaryType:n.itemData.value});i.load()},r=[],n.items.push({text:"Summary Type",items:r}),$.each(["Sum","Avg","Min","Max","Count"],function(t,i){var f=i.toLowerCase();r.push({text:i,value:i.toLowerCase(),onItemClick:u,selected:n.field.summaryType===f})})))}var n;console.log("dashboard ready");var i=$("#pivotgrid-chart").dxChart({commonSeriesSettings:{type:"bar"},tooltip:{enabled:!0,customizeTooltip:function(n){return{html:n.seriesName+"<div class='currency'>"+n.originalValue+"<\/div>"}}},size:{height:320},adaptiveLayout:{width:450}}).dxChart("instance"),t=$("#pivotgrid").dxPivotGrid({allowSortingBySummary:!0,allowSorting:!0,allowFiltering:!0,allowExpandAll:!0,wordWrapEnabled:!0,allowColumnResizing:!0,columnResizingMode:"widget",height:600,showBorders:!0,fieldChooser:{enabled:!0,applyChangesMode:"instantly",allowSearch:!0},dataSource:{fields:[{caption:"Submission State",width:120,dataField:"submissionStateDisplay",area:"row"},{caption:"Due Year",dataField:"dueYear",area:"column"},{caption:"Submission",dataField:"id",area:"data"},{dataField:"id",visible:!1},{dataField:"submissionState",visible:!1},{dataField:"$id",visible:!1},{dataField:"canCancel",visible:!1},{dataField:"canReopen",visible:!1},{dataField:"canReview",visible:!1},{dataField:"canStart",visible:!1},{dataField:"canWaiver",visible:!1},{dataField:"hasAdmin",visible:!1},{dataField:"hasStarted",visible:!1},{dataField:"isGroupMember",visible:!1},{dataField:"reportAction",visible:!1},{dataField:"reopenDisabled",visible:!1},{dataField:"startDisabled",visible:!1},{dataField:"generationUserGroup",visible:!1},{dataField:"approvalUserGroup",visible:!1},{dataField:"submissionUserGroup",visible:!1},{dataField:"submissionUserGroup",visible:!1},{dataField:"nextDueDate",visible:!1},{dataField:"approverEmailAddresses",visible:!1},{dataField:"generatorEmailAddresses",visible:!1},{dataField:"approvers",visible:!1},{dataField:"generators",visible:!1},{dataField:"submitters",visible:!1},{dataField:"currentReportId",visible:!1},{dataField:"dataGroups",visible:!1},{dataField:"displayDataYear",visible:!1}],store:DevExpress.data.AspNet.createStore({key:"id",loadUrl:"/api/submission"})},fieldPanel:{showColumnFields:!0,showDataFields:!0,showFilterFields:!0,showRowFields:!0,allowFieldDragging:!0,visible:!0},stateStoring:{enabled:!0,type:"localStorage",storageKey:"pivotgridFilterStorage"},onContextMenuPreparing:r,onCellClick:function(t){if(t.area==="data"){var r=t.component.getDataSource(),u=t.cell.rowPath.length,i=t.cell.rowPath[u-1],f=(i?i:"Total")+" Drill Down Data";drillDownDataSource=r.createDrillDownDataSource(t.cell);n.option("title",f);n.show()}}}).dxPivotGrid("instance");t.bindChart(i,{dataFieldsDisplayMode:"splitPanes",alternateDataFields:!1});$("#btnReset").on("click",function(n){n.preventDefault();t.getDataSource().state({})});n=$("#detail-popup").dxPopup({width:700,height:600,dragEnabled:!0,resizeEnabled:!0,contentTemplate:function(n){$("<div />").addClass("drill-down").dxDataGrid({width:"100%",height:"100%",wordWrapEnabled:!0,allowColumnResizing:!0,columnResizingMode:"widget",columnAutoWidth:!0,showFooter:!0,filterRow:{visible:!0,applyFilter:"auto"},filterPanel:{visible:!0},focusedRowEnabled:!0,columns:[{dataField:"fileNumber",caption:"File Number",width:100},{dataField:"fileName",caption:"File Name"},{dataField:"currentAssignment",caption:"Assigned"},{dataField:"dueDate",caption:"Due Date",dataType:"date"},{dataField:"lastUpdatedFriendly",caption:"Last Updated"}]}).appendTo(n)},onShowing:function(){$(".drill-down").dxDataGrid("instance").option("dataSource",drillDownDataSource)},onShown:function(){$(".drill-down").dxDataGrid("instance").updateDimensions()}}).dxPopup("instance")});