"use strict";(function(){function i(t,i){var r=i.id;BootstrapDialog.confirm("Retire File Specification, are you sure?",function(t){t&&(window.$showModalWorking(),$.ajax({url:"/api/filespecification/activate/"+r,type:"POST",success:function(t){n.refresh();toastr.success("Activated file for "+t.fileName+" ("+t.fileNumber+")")},error:function(){toastr.error("Error activating file")}}).always(function(){window.$hideModalWorking()}))})}function r(t,i){var r=i.id;BootstrapDialog.confirm("Retire File Specification, are you sure?",function(t){t&&(window.$showModalWorking(),$.ajax({url:"/api/filespecification/retire/"+r,type:"POST",success:function(t){toastr.warning("Retired file for "+t.fileName+" ("+t.fileNumber+")");n.refresh()},error:function(){toastr.error("Error retiring file")}}).always(function(){window.$hideModalWorking()}))})}function u(t,i){var r="/home/editfileSpecification/"+i.id,u="/api/filespecification/save/"+i.id;BootstrapDialog.show({type:BootstrapDialog.TYPE_WARNING,size:window.BootstrapDialog.SIZE_WIDE,draggable:!0,title:"Edit File Specification",message:$("<div><\/div>").load(r,function(n,t){t==="error"&&window.$log.error("Error showing history")}),buttons:[{label:"Close",action:function(n){n.close()}},{label:"Save",cssClass:"btn-primary",action:function(t){t.enableButtons(!1);t.setClosable(!1);$showModalWorking($(".panel-body"));var i=$("form").serializeJSON();$.ajax({contentType:"application/json; charset=utf-8",type:"POST",url:u,data:JSON.stringify(i),dataType:"json",success:function(i){toastr.success("Saved changes for "+i.fileName+" ("+i.fileNumber+")");t.close();n.refresh()},error:function(n){console.log("error",n);toastr.error("Error saving file changes")},complete:function(){}})}}]})}var t="/api/filespecification",n=$("#grid").dxDataGrid({dataSource:DevExpress.data.AspNet.createStore({key:"id",loadUrl:t,updateUrl:t}),remoteOperations:!0,allowColumnResizing:!0,allowColumnReordering:!0,showBorders:!0,wordWrapEnabled:!0,"export":{enabled:!0,fileName:"FileSpecifications",allowExportSelectedData:!1,icon:"fa fa-trash"},stateStoring:{enabled:!0,type:"localStorage",storageKey:"gridFileSpecificationFilterStorage"},filterRow:{visible:!0},headerFilter:{visible:!0},groupPanel:{visible:!0},scrolling:{mode:"virtual",rowRenderingMode:"virtual"},paging:{pageSize:20},height:650,columnChooser:{enabled:!0},columnResizingMode:"nextColumn",columnMinWidth:50,columnAutoWidth:!0,columns:[{dataField:"fileNumber",caption:"File Number",dataType:"string"},{dataField:"fileName",caption:"File Name",dataType:"string"},{dataField:"isRetired",caption:"Retired",dataType:"boolean",visible:!0,showEditorAlways:!1,trueText:"Yes",falseText:"No",customizeText:function(n){return n.value?"Yes":"No"}},{dataField:"section",caption:"Section",dataType:"string"},{dataField:"supportGroup",caption:"Support Group",dataType:"string"},{dataField:"application",caption:"Application",dataType:"string"},{dataField:"collection",caption:"Collection",dataType:"string"},{dataField:"reportAction",caption:"Report Action",dataType:"string",visible:!1},{dataField:"generationGroup",caption:"Generation Group",dataType:"string",visible:!1},{dataField:"approvalGroup",caption:"Approval Group",dataType:"string",visible:!1},{dataField:"submissionGroup",caption:"Submission Group",dataType:"string",visible:!1},{dataField:"generators",caption:"Generators",dataType:"string",cellTemplate:function(n,t){t.data.generators.forEach(function(t){$("<span>"+t+"<\/span><br />").appendTo(n)})},allowFiltering:!1,calculateDisplayValue:function(n){return n.generators.join(", ")}},{dataField:"approvers",caption:"Approvers",dataType:"string",cellTemplate:function(n,t){t.data.approvers.forEach(function(t){$("<span>"+t+"<\/span><br />").appendTo(n)})},allowFiltering:!1,calculateDisplayValue:function(n){return n.approvers.join(", ")}},{dataField:"submitters",caption:"Submitters",dataType:"string",cellTemplate:function(n,t){t.data.submitters.forEach(function(t){$("<span>"+t+"<\/span><br />").appendTo(n)})},allowFiltering:!1,calculateDisplayValue:function(n){return n.submitters.join(", ")}},{dataField:"isSEA",caption:"SEA",dataType:"boolean",visible:!1,showEditorAlways:!1,trueText:"Yes",falseText:"No",customizeText:function(n){return n.value?"Yes":"No"}},{dataField:"isLEA",caption:"LEA",dataType:"boolean",visible:!1,showEditorAlways:!1,trueText:"Yes",falseText:"No",customizeText:function(n){return n.value?"Yes":"No"}},{dataField:"isSCH",caption:"SCH",dataType:"boolean",visible:!1,showEditorAlways:!1,trueText:"Yes",falseText:"No",customizeText:function(n){return n.value?"Yes":"No"}},{width:120,alignment:"center",cellTemplate:function(n,t){$("<a/>").addClass("btn btn-default btn-sm btn-grid").text("Edit").attr("aria-label","Edit "+t.data.fileName).on("dxclick",function(){u($(this),t.data)}).appendTo(n);t.data.canRetire&&$("<a/>").addClass("btn btn-default btn-sm btn-grid").text("Retire").attr("aria-label","Retire "+t.data.fileName).on("dxclick",function(){r($(this),t.data)}).appendTo(n);t.data.canActivate&&$("<a/>").addClass("btn btn-default btn-sm btn-grid").text("Activate").attr("aria-label","Activate "+t.data.fileName).on("dxclick",function(){i($(this),t.data)}).appendTo(n)}}],sortByGroupSummaryInfo:[{summaryItem:"count"}],summary:{totalItems:[{column:"id",displayFormat:"{0} Total File Specifications",summaryType:"count",showInGroupFooter:!0,showInColumn:"FileNumber"}],groupItems:[{summaryType:"count",displayFormat:"{0} File Specifications"}]},onToolbarPreparing:function(n){var t=n.component;n.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{text:"Collapse All",width:136,onClick:function(n){var i=n.component.option("text")==="Expand All";t.option("grouping.autoExpandAll",i);n.component.option("text",i?"Collapse All":"Expand All")}}},{location:"after",widget:"dxButton",options:{icon:"refresh",hint:"Refresh",onClick:function(){t.refresh()}}},{location:"after",widget:"dxButton",options:{icon:"clearformat",hint:"Clear filters",onClick:function(){t.clearFilter()}}},{location:"after",widget:"dxButton",options:{icon:"clearsquare",hint:"Reset grid to default",onClick:function(){t.state({})}}})}}).dxDataGrid("instance")})();